<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Pre-Processing ActionScript files / classes</title>
        <meta name="viewport" content="width=device-width">

		<script type="text/javascript" src="//use.typekit.net/gib0bhv.js"></script>
		<script type="text/javascript">try{Typekit.load();}catch(e){}</script>

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/blog/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/blog/css/main.css">

    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/blog/">mike chambers</a> | <a href="">about</a></h1>
          </div>

          <h2>Pre-Processing ActionScript files / classes</h2>
<p class="meta">Wednesday, March 30, 2005</p>

<div class="post">
<p>One thing I often do in my code is create custom trace / output functions that recursively go through and print out properties. However, this requires that I add some custom code to my classes which I don&#8217;t really want in the final version.</p>

<p>So, I started exploring pre-processors that I could use to make it easier to add and remove debugging code. I first looked at <a href="http://www.gnu.org/software/m4/">m4</a>. While it seems to be very powerful, it was overkill for what I needed, and looked to be very difficult to use. Christian Cantrell then suggested that I look at <a href="http://gcc.gnu.org/onlinedocs/cpp/">cpp</a>, a C pre-processor. I checked it out, and it does exactly what I need, in an easy to learn and use syntax.</p>

<!--more-->

<p>For example, here is a simple class, in a file call HelloWorld.p</p>

<p><code class="inline-code">
<pre>class HelloWorld
{
    function HelloWorld()
    {
        #ifdef DEBUG
            trace("Hello World Loaded");
        #endif
    }
}</pre>
<p></code></p>

<p><a href="http://gcc.gnu.org/onlinedocs/cpp/Ifdef.html#Ifdef">#ifdef</a> is a cpp directive that is basically an if statement. If the DEBUG variable is defined, then the block will be included in the generated file, if not, then it will be omitted.</p>

<p>I then run this file through cpp like so:</p>

<p><em>cpp -D DEBUG -P HelloWorld.p HelloWorld.as</em></p>

<p>The <em>-D DEBUG</em> defines the DEBUG variable. <em>-P</em> tells cpp to not insert line-markers in the generated file. You have to use this for ActionScript or else Flash won&#8217;t compile your file. (You can find a completel list of command-line args <a href="http://gcc.gnu.org/onlinedocs/cpp/Invocation.html#Invocation">here</a>).</p>

<p>Running this results in the following HellowWorld.as file:</p>

<p><code class="inline-code">
<pre>class HelloWorld
{
    function HelloWorld()
    {
            trace("Hello World Loaded");
    }
}</pre>
<p></code></p>

<p>Running it without defining DEBUG:</p>

<p><em>cpp -P HelloWorld.p HelloWorld.as</em></p>

<p>results in the following file:</p>

<p><code class="inline-code">
<pre>class HelloWorld
{
    function HelloWorld()
    {
    }
}</pre>
<p></code></p>

<p>With the trace statement removed.</p>

<p>Note that by default, cpp will remove any comments from the generated AS file. If you want it to keep the comments in the file, just add <em>-C</em> to the argumenst that you pass to cpp</p>

<p>Anyways, this is just a simple example. There are a <a href="http://gcc.gnu.org/onlinedocs/cpp/">ton of directives</a> you can use, and you can also define your own.</p>

<p>The main thing that you have to remember is that you must run your class file through cpp before it is compiled by Flash. Flash is compiling the file generated by cpp, and not the file you are editing.</p>

<p>You can find more info on cpp <a href="http://gcc.gnu.org/onlinedocs/cpp/">here</a>, and you can download it from <a href="http://directory.fsf.org/gcc.html">here</a> (it is included with the GCC compiler).</p>

<p>Note, cpp is included on Mac OS X, but for some reason would not work for me. I had to download the source, and compile it before I could get it to work. If anyone can get it to work on Mac, let me know in the comments.</p>

<p>Post any additional tips / uses of cpp with ActionScript, or suggestions in the comments.</p>

</div>


          <div class="footer">
			<p>Copyright 2013 - Mike Chambers</p>
        </div>
		
		<div id="social">
			<a href="http://www.twitter.com/mesh/"><image src="/blog/images/social/twitter.png" width="50" height="50" alt="twitter" /></a>
			<a href="https://github.com/mikechambers/"><image src="/blog/images/social/github.png" width="50" height="50" alt="github" /></a>
			<a href="http://www.flickr.com/photos/mikechambers/"><image src="/blog/images/social/flickr.png" width="50" height="50" alt="flickr" /></a>
			<a href="http://www.behance.net/mikechambers"><image src="/blog/images/social/behance.png" width="50" height="50" alt="behance" /></a>
			<a href="http://www.twitter.com/mesh/"><image src="/blog/images/social/rss.png" width="50" height="50" alt="rss" /></a>
		</div>

    </body>
</html>
